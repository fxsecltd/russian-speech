<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="PSPad editor, www.pspad.com">
  <title></title>
  </head>
  <body>
  <h1>Отгадай значение байта скалярного множителя точки эллиптической кривой вида secp256k1 с координатами:</h1>
  <h2>x = 90787401320727782099222737278987262552976445620325143715166301034566612554851</h2>
  <h2>y = 55114297363690809288511507979336207137253584159871431976102934965022666078378</h2>
  <h3><a href='javascript:startIt()'>Начать</a></h3>
  <form action="#">
    <label for="fname">Email:</label>
    <input type="text" id="fname" name="fname"><br><br>
  </form>  
  <h3 id="counter"></h3>
  <h3 id="prompts"></h3>
  <div id = "tbl" style="1200px;height=1200px;display:grid;grid-column-gap:15px;grid-template-columns:2% 2% 2% 2% 2% 2% 2% 2% 2% 2% 2% 2% 2% 2% 2% 2%;"></div>
  <script type="text/javascript">
    var positions = new Array();
    var values = new Array();
    var pointer = 0;
    var result = new Array(33);
    createArrays();
    createTable();
    function createArrays()
    {
      result[0] = "0x";
      for(var i=0; i<32; i++)
      {
        positions[i] = i+1;
      }
      for(var r = 0; r < 16; r++)
      {
        for(var c = 0; c < 16; c++)
        {
          if(r==0)
          {
            values[r*16+c] = "0"+(r*16+c).toString(16);
          }else
          {
            values[r*16+c] = (r*16+c).toString(16);
          }
        }
      } 
    };
    function shuffle(array) 
    {
      array.sort(() => Math.random() - 0.5);
    };
    function nextStep()
    {
      prepare();
      document.getElementById("counter").innerText = (pointer+1).toString() + "/32";
      document.getElementById("prompts").innerText = "Угадай значение байта на позиции " + positions[pointer] + " и кликни по нему";
    };
    function startIt()
    {
      shuffle(positions);
      pointer = 0;
      result[0] = "0x";
      nextStep();
    };
    function jobDone()
    {
      pointer = 0;
      result = new Array(33);
      result[0] = "0x";
      alert("Результат отправлен успешно");
      document.getElementById("counter").innerText = (pointer+1).toString() + "/32";
    }
    function handleClick(event)
    {
      if(pointer < 32)
      {
        result[positions[pointer]] = document.getElementById(event.target.id).innerText;
        pointer++;
        if(pointer < 32)
        {
          nextStep();
        }else
        {
          setTimeout(jobDone,4000)
          var xmlHttp = new XMLHttpRequest();
          xmlHttp.open("GET", "https://script.google.com/macros/s/AKfycbyb_WB6vg1zMaff8Npzdr7guq5wRtkLjh6uo6OeDFQSLJmPNW8/exec?" + "p1=" + document.getElementById("fname").value + "&p2=" + result.join(""), false );
          xmlHttp.onreadystatechange = function () 
          {
          };
          xmlHttp.send();
        }
      }
    };
    function prepare()
    {
      shuffle(values);  
      for(var r = 0; r < 16; r++)
      {
        for(var c = 0; c < 16; c++)
        {
          document.getElementById(String.fromCharCode(65+r)+String.fromCharCode(65+c)).innerText = values[r*16+c];
        }
      } 
    };  
    function createTable()
    {
      for(var r = 0; r < 16; r++)
      {
        for(var c = 0; c < 16; c++)
        {
          d = document.createElement("div");
          d.style.cssText = "outline:2px solid #000;background:#fc0;border:3px solid #fff;border-radius:10px;text-align:center;";
          d.setAttribute("id",String.fromCharCode(65+r)+String.fromCharCode(65+c));
          d.addEventListener("click", handleClick);
          document.getElementById("tbl").appendChild(d);  
        }
      } 
    };
  </script>
  </body>
</html>
